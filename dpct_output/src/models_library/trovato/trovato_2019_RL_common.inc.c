// Avoid NaN errors
if (V >= 200.0) V = 200.0;

// Constants
real nao = 140;
real cao = 1.8;
real ko = 5.4;
real R = 8314;
real T = 310;
real F = 96485;
real zna = 1;
real zca = 2;
real zk = 1;
real L = 0.0164;
real rad = 0.00175;
real greekpi = 3.14159265;
real KmCaMK = 0.15;
real aCaMK = 0.05;
real bCaMK = 0.00068;
real CaMKo = 0.05;
real KmCaM = 0.0015;
real BSRmax = 0.019975;
real KmBSR = 0.00087;
real BSLmax = 0.4777;
real KmBSL = 0.0087;
real csqnmax = 2.88;
real kmcsqn = 0.8;
real csqnmaxsl = 1.2;
real cmdnmax = 0.1125;
real kmcmdn = 0.00238;
real cmdnmaxsl = 0.0125;
real trpnmax = 0.0315;
real kmtrpn = 0.0005;
real trpnmaxsl = 0.0035;
real cm = 1;
real PKNa = 0.01833;
real mssV1 = 48.4264;
real mssV2 = 7.5653;
real mtV1 = 11.64;
real mtV2 = 34.77;
real mtD1 = 6.765;
real mtD2 = 8.552;
real mtV3 = 77.42;
real mtV4 = 5.955;
real hssV1 = 78.5;
real hssV2 = 6.22;
real Ahf = 0.99;
real GNa = 39.4572;
real thL = 200;
real GNaL = 0.0189;
real Gto = 0.192;
real Gsus = 0.0301;
real Kmn = 0.002;
real k2n = 1000;
real PCa = 7.7677e-5;
real GCaT = 0.0754;
real GKr = 0.0342;
real GKs = 0.0029;
real GfNa = 0.0116;
real GfK = 0.0232;
real GK1 = 0.0455;
real kna1 = 15;
real kna2 = 5;
real kna3 = 88.12;
real kasymm = 12.5;
real wna = 60000;
real wca = 60000;
real wnaca = 5000;
real kcaon = 1500000;
real kcaoff = 5000;
real qna = 0.5224;
real qca = 0.167;
real KmCaAct = 0.00015;
real Gncx = 0.00095709;
real k1p = 949.5;
real k1m = 182.4;
real k2p = 687.2;
real k2m = 39.4;
real k3p = 1899;
real k3m = 79300;
real k4p = 639;
real k4m = 40;
real Knai0 = 9.073;
real Knao0 = 27.78;
real delta = -0.155;
real Kki = 0.5;
real Kko = 0.3582;
real MgADP = 0.05;
real MgATP = 9.8;
real Kmgatp = 1.698e-7;
real H = 1e-7;
real eP = 4.2;
real Khp = 1.698e-7;
real Knap = 224;
real Kxkur = 292;
real Pnak = 32.4872;
real PNab = 9.375e-10;
real PCab = 2.5e-8;
real GpCa = 0.0005;
real KmCap = 0.0005;
real sstau = 0.2;
real gaptau = 12;
real dqupcamkbar = 0.75;
real dkmplbbar = 0.00017;
real kmup = 0.00028;
real nsrbar = 15;
real IP3 = 0.0001;
real k1 = 150000;
real k1a = 16.5;
real k0 = 96000;
real k0a = 9.6;
real k2 = 1800;
real k2a = 0.21;
real tauip3 = 3.7;
real Ahs = 1.00000 - Ahf;
real thLp =  3.00000*thL;
real Aff = 0.600000;
real PCap =  1.10000*PCa;
real PCaNa =  0.00125000*PCa;
real PCaK =  0.000357400*PCa;
real tjca = 75.0000;
real vcell =  1000.00*3.14159*rad*rad*L;
real Afs = 1.00000 - Aff;
real PCaNap =  0.00125000*PCap;
real PCaKp =  0.000357400*PCap;
real Ageo =  2.00000*greekpi*rad*rad+ 2.00000*greekpi*rad*L;
real Acap =  2.00000*Ageo;
real vmyo =  0.600000*vcell;
real vnsr =  0.0400000*vcell;
real vjsr =  0.00200000*vcell;
real vcsr =  0.00800000*vcell;
real vss =  0.0200000*vcell;
real vsl =  0.150000*vcell;
real h10_i = kasymm+1.00000+ (nao/kna1)*(1.00000+nao/kna2);
real h11_i = ( nao*nao)/( h10_i*kna1*kna2);
real h12_i = 1.00000/h10_i;
real k1_i =  h12_i*cao*kcaon;
real k2_i = kcaoff;
real k5_i = kcaoff;
real h10_ss = kasymm+1.00000+ (nao/kna1)*(1.00000+nao/kna2);
real h11_ss = ( nao*nao)/( h10_ss*kna1*kna2);
real h12_ss = 1.00000/h10_ss;
real k1_ss =  h12_ss*cao*kcaon;
real k2_ss = kcaoff;
real k5_ss = kcaoff;
real k7_ss =  k1m*MgADP;
real a2 = k2p;
real a4 = (( k4p*MgATP)/Kmgatp)/(1.00000+MgATP/Kmgatp);

// Algebraics
real hLss = 1.00000/(1.00000+exp((V+87.6100)/7.48800));
real hLssp = 1.00000/(1.00000+exp((V+93.8100)/7.48800));
real mss = 1.00000/(1.00000+exp(- (V+mssV1)/mssV2));
real tm = 1.00000/( mtD1*exp((V+mtV1)/mtV2)+ mtD2*exp(- (V+mtV3)/mtV4));
real hss = 1.00000/(1.00000+exp((V+hssV1)/hssV2));
real thf = 1.00000/( 3.68600e-06*exp(- (V+3.88750)/7.85790)+ 16.0000*exp((V - 0.496300)/9.18430));
real ths = 1.00000/( 0.00979400*exp(- (V+17.9500)/28.0500)+ 0.334300*exp((V+5.73000)/56.6600));
real ass = 1.00000/(1.00000+exp((20.0000 - V)/13.0000));
real taua = 1.05150/(1.00000/( 1.20890*(1.00000+exp(- (V - 18.4099)/29.3814)))+3.50000/(1.00000+exp((V+100.000)/29.3814)));
real iss = 1.00000/(1.00000+exp((27.0000+V)/13.0000));
real tauis = 43.0000+1.00000/( 0.00141600*exp(- (V+96.5200)/59.0500)+ 1.78000e-08*exp((V+114.100)/8.07900));
real tauif = 6.16200+1.00000/( 0.393300*exp(- (V+100.000)/100.000)+ 0.0800400*exp((V - 8.00000)/8.59000));
real dss = 1.00000/(1.00000+exp(- (V+3.94000+3.30000)/4.23000));
real td = 0.600000+1.00000/(exp( - 0.0500000*(V+6.00000))+exp( 0.0900000*(V+14.0000)));
real fss = 1.00000/(1.00000+exp((V+19.5800+3.30000)/3.69600));
real tff = 7.00000+1.00000/( 0.00450000*exp(- (V+20.0000+15.1900)/10.0000)+ 0.00450000*exp((V+20.0000+15.1900)/10.0000));
real tfs = 1000.00+1.00000/( 3.50000e-05*exp(- (V+5.00000+15.1900)/4.00000)+ 3.50000e-05*exp((V+5.00000+15.1900)/6.00000));
real fcass = fss;
real km2n =  jca*1.00000;
real anca = 1.00000/(k2n/km2n+pow(1.00000+Kmn/cass, 4.00000));
real bss = 1.00000/(1.00000+exp(- (V+30.0000)/7.00000));
real taub = 1.00000/( 1.06800*exp((V+16.3000)/30.0000)+ 1.06800*exp(- (V+16.3000)/30.0000));
real gss = 1.00000/(1.00000+exp((V+61.0000)/5.00000));
real taug = 1.00000/( 0.0150000*exp((V+71.7000)/15.4000)+ 0.0150000*exp(- (V+71.7000)/83.3000));
real xrss = 1.00000/(1.00000+exp(- (V+8.33700)/6.78900));
real txrf = 12.9800+1.00000/( 0.365200*exp(((V+17.6000) - 31.6600)/3.86900)+ 4.12300e-05*exp(- ((V+17.6000) - 47.7800)/20.3800));
real txrs = 1.86500+1.00000/( 0.0662900*exp(((V+17.2000) - 34.7000)/7.35500)+ 1.12800e-05*exp(- ((V+17.2000) - 29.7400)/25.9400));
real xs1ss = 1.00000/(1.00000+exp(- (V+11.6000)/8.93200));
real txs1 = 817.300+1.00000/( 0.000232600*exp((V+48.2800)/17.8000)+ 0.00129200*exp(- (V+210.000)/230.000));
real yss = 1.00000/(1.00000+exp((V+87.0000)/9.50000));
real tauy = 2000.00/(exp((V+57.0000)/60.0000)+exp(- (V+132.000)/10.0000));
real xk1ss = 1.00000/(1.00000+exp(- (V+ 2.55380*ko+144.590)/( 1.56920*ko+3.81150)));
real txk1 = 122.200/(exp(- (V+127.200)/20.3600)+exp((V+236.800)/69.3300));
real jss = hss;
real tj = 4.85900+1.00000/( 0.862800*exp(- (V+116.726)/7.60050)+ 1.10960*exp((V+6.27190)/9.03580));
real tfcaf =  0.720000*(7.00000+1.00000/( 0.0400000*exp(- ((V+15.1900) - 4.00000)/7.00000)+ 0.0400000*exp(((V+15.1900) - 4.00000)/7.00000)));
real tfcas =  0.490000*(100.000+1.00000/( 0.000120000*exp(- (V+15.1900)/3.00000)+ 0.000120000*exp((V+15.1900)/7.00000)));
real tffp =  2.50000*tff;
real xs2ss = xs1ss;
real txs2 = 1.00000/( 0.0100000*exp((V - 50.0000)/20.0000)+ 0.0193000*exp(- (V+66.5400)/31.0000));
real CaMKb = ( CaMKo*(1.00000 - CaMKt))/(1.00000+KmCaM/cass);
real hssp = 1.00000/(1.00000+exp((V+84.7000)/6.22000));
real thsp =  3.00000*ths;
real tjp =  1.46000*tj;
real mLss = 1.00000/(1.00000+exp(- (V+42.8500)/5.26400));
real tmL = tm;
real tfcafp =  2.50000*tfcaf;
real f =  Aff*ff+ Afs*fs;
real Afcaf = 0.300000+0.600000/(1.00000+exp((V - 10.0000)/10.0000));
real Afcas = 1.00000 - Afcaf;
real fca =  Afcaf*fcaf+ Afcas*fcas;
real fp =  Aff*ffp+ Afs*fs;
real fcap =  Afcaf*fcafp+ Afcas*fcas;
real vffrt = ( V*F*F)/( R*T);
real vfrt = ( V*F)/( R*T);
real PhiCaK = ( 1.00000*vffrt*( 0.750000*kss*exp( 1.00000*vfrt) -  0.750000*ko))/(exp( 1.00000*vfrt) - 1.00000);
real CaMKa = CaMKb+CaMKt;
real fICaLp = 1.00000/(1.00000+KmCaMK/CaMKa);
real ICaK =  (1.00000 - fICaLp)*PCaK*PhiCaK*d*( f*(1.00000 - nca)+ jca*fca*nca)+ fICaLp*PCaKp*PhiCaK*d*( fp*(1.00000 - nca)+ jca*fcap*nca);
real JdiffK = (kss - ksl)/sstau;
real PhiCaNa = ( 1.00000*vffrt*( 0.750000*nass*exp( 1.00000*vfrt) -  0.750000*nao))/(exp( 1.00000*vfrt) - 1.00000);
real ICaNa =  (1.00000 - fICaLp)*PCaNa*PhiCaNa*d*( f*(1.00000 - nca)+ jca*fca*nca)+ fICaLp*PCaNap*PhiCaNa*d*( fp*(1.00000 - nca)+ jca*fcap*nca);
real allo_ss = 1.00000/(1.00000+pow(KmCaAct/cass, 2.00000));
real hna = exp(( qna*V*F)/( R*T));
real h7_ss = 1.00000+ (nao/kna3)*(1.00000+1.00000/hna);
real h8_ss = nao/( kna3*hna*h7_ss);
real k3pp_ss =  h8_ss*wnaca;
real h1_ss = 1.00000+ (nass/kna3)*(1.00000+hna);
real h2_ss = ( nass*hna)/( kna3*h1_ss);
real k4pp_ss =  h2_ss*wnaca;
real h4_ss = 1.00000+ (nass/kna1)*(1.00000+nass/kna2);
real h5_ss = ( nass*nass)/( h4_ss*kna1*kna2);
k7_ss =  h5_ss*h2_ss*wna;
real k8_ss =  h8_ss*h11_ss*wna;
real h9_ss = 1.00000/h7_ss;
real k3p_ss =  h9_ss*wca;
real k3_ss = k3p_ss+k3pp_ss;
real hca = exp(( qca*V*F)/( R*T));
real h3_ss = 1.00000/h1_ss;
real k4p_ss = ( h3_ss*wca)/hca;
real k4_ss = k4p_ss+k4pp_ss;
real h6_ss = 1.00000/h4_ss;
real k6_ss =  h6_ss*cass*kcaon;
real x1_ss =  k2_ss*k4_ss*(k7_ss+k6_ss)+ k5_ss*k7_ss*(k2_ss+k3_ss);
real x2_ss =  k1_ss*k7_ss*(k4_ss+k5_ss)+ k4_ss*k6_ss*(k1_ss+k8_ss);
real x3_ss =  k1_ss*k3_ss*(k7_ss+k6_ss)+ k8_ss*k6_ss*(k2_ss+k3_ss);
real x4_ss =  k2_ss*k8_ss*(k4_ss+k5_ss)+ k3_ss*k5_ss*(k1_ss+k8_ss);
real E1_ss = x1_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real E2_ss = x2_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real E3_ss = x3_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real E4_ss = x4_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real JncxNa_ss = ( 3.00000*( E4_ss*k7_ss -  E1_ss*k8_ss)+ E3_ss*k4pp_ss) -  E2_ss*k3pp_ss;
real JncxCa_ss =  E2_ss*k2_ss -  E1_ss*k1_ss;
real INaCa_ss =  0.200000*Gncx*allo_ss*( zna*JncxNa_ss+ zca*JncxCa_ss);
real JdiffNa = (nass - nasl)/sstau;
real JgapK = (ksl - ki)/gaptau;
real EK =  (( R*T)/F)*log(ko/ksl);
real Ito =  Gto*a*i1*i2*(V - EK);
real asus = 1.00000/(1.00000+exp(- (V - 12.0000)/16.0000));
real Isus =  Gsus*asus*(V - EK);
real Axrf = 1.00000/(1.00000+exp((V+54.8100)/38.2100));
real Axrs = 1.00000 - Axrf;
real xr =  Axrf*xrf+ Axrs*xrs;
real rkr = ( (1.00000/(1.00000+exp((V+55.0000)/( 0.320000*75.0000))))*1.00000)/(1.00000+exp((V - 10.0000)/( 0.320000*30.0000)));
real IKr =  GKr* pow((ko/5.40000), 1.0 / 2)*xr*rkr*(V - EK);
real EKs =  (( R*T)/F)*log((ko+ PKNa*nao)/(ksl+ PKNa*nasl));
real KsCa = 1.00000+0.600000/(1.00000+pow(3.80000e-05/casl, 1.40000));
real IKs =  GKs*KsCa*xs1*xs2*(V - EKs);
real rk1 = 1.00000/(1.00000+exp(((V+116.000) -  5.50000*ko)/11.0000));
real IK1 =  GK1*2.32380* pow((ko/5.40000), 1.0 / 2)*rk1*xk1*(V - EK);
real Knao =  Knao0*exp(( (1.00000 - delta)*V*F)/( 3.00000*R*T));
real a3 = ( k3p*pow(ko/Kko, 2.00000))/((pow(1.00000+nao/Knao, 3.00000)+pow(1.00000+ko/Kko, 2.00000)) - 1.00000);
real P = eP/(1.00000+H/Khp+nasl/Knap+ksl/Kxkur);
real b3 = ( k3m*P*H)/(1.00000+MgATP/Kmgatp);
real Knai =  Knai0*exp(( delta*V*F)/( 3.00000*R*T));
real a1 = ( k1p*pow(nasl/Knai, 3.00000))/((pow(1.00000+nasl/Knai, 3.00000)+pow(1.00000+ksl/Kki, 2.00000)) - 1.00000);
real b2 = ( k2m*pow(nao/Knao, 3.00000))/((pow(1.00000+nao/Knao, 3.00000)+pow(1.00000+ko/Kko, 2.00000)) - 1.00000);
real b4 = ( k4m*pow(ksl/Kki, 2.00000))/((pow(1.00000+nasl/Knai, 3.00000)+pow(1.00000+ksl/Kki, 2.00000)) - 1.00000);
real x1 =  a4*a1*a2+ b2*b4*b3+ a2*b4*b3+ b3*a1*a2;
real x2 =  b2*k7_ss*b4+ a1*a2*a3+ a3*k7_ss*b4+ a2*a3*b4;
real x3 =  a2*a3*a4+ b3*b2*k7_ss+ b2*k7_ss*a4+ a3*a4*k7_ss;
real x4 =  b4*b3*b2+ a3*a4*a1+ b2*a4*a1+ b3*b2*a1;
real E1 = x1/(x1+x2+x3+x4);
real E2 = x2/(x1+x2+x3+x4);
real JnakNa =  3.00000*( E1*a3 -  E2*b3);
real E3 = x3/(x1+x2+x3+x4);
real E4 = x4/(x1+x2+x3+x4);
real JnakK =  2.00000*( E4*k7_ss -  E3*a1);
real INaK =  Pnak*( zna*JnakNa+ zk*JnakK);
real Istim = calc_I_stim;
real IfK =  GfK*y*y*(V - EK);
real ENa =  (( R*T)/F)*log(nao/nasl);
real h =  Ahf*hf+ Ahs*hs;
real hp =  Ahf*hf+ Ahs*hsp;
real fINap = 1.00000/(1.00000+KmCaMK/CaMKa);
real INa =  GNa*(V - ENa)*pow(m, 3.00000)*( (1.00000 - fINap)*h*j+ fINap*hp*jp);
real fINaLp = 1.00000/(1.00000+KmCaMK/CaMKa);
real INaL =  GNaL*(V - ENa)*mL*( (1.00000 - fINaLp)*hL+ fINaLp*hLp);
real PhiCaL = ( 4.00000*vffrt*( cass*exp( 2.00000*vfrt) -  0.341000*cao))/(exp( 2.00000*vfrt) - 1.00000);
real ICaL =  (1.00000 - fICaLp)*PCa*PhiCaL*d*( f*(1.00000 - nca)+ jca*fca*nca)+ fICaLp*PCap*PhiCaL*d*( fp*(1.00000 - nca)+ jca*fcap*nca);
real ECa =  (( R*T)/( 2.00000*F))*log(cao/casl);
real ICaT =  GCaT*b*g*(V - ECa);
real IfNa =  GfNa*y*y*(V - ENa);
real If = IfNa+IfK;
real allo_i = 1.00000/(1.00000+pow(KmCaAct/casl, 2.00000));
real h7_i = 1.00000+ (nao/kna3)*(1.00000+1.00000/hna);
real h8_i = nao/( kna3*hna*h7_i);
real k3pp_i =  h8_i*wnaca;
real h1_i = 1.00000+ (nasl/kna3)*(1.00000+hna);
real h2_i = ( nasl*hna)/( kna3*h1_i);
real k4pp_i =  h2_i*wnaca;
real h4_i = 1.00000+ (nasl/kna1)*(1.00000+nasl/kna2);
real h5_i = ( nasl*nasl)/( h4_i*kna1*kna2);
real k7_i =  h5_i*h2_i*wna;
real k8_i =  h8_i*h11_i*wna;
real h9_i = 1.00000/h7_i;
real k3p_i =  h9_i*wca;
real k3_i = k3p_i+k3pp_i;
real h3_i = 1.00000/h1_i;
real k4p_i = ( h3_i*wca)/hca;
real k4_i = k4p_i+k4pp_i;
real h6_i = 1.00000/h4_i;
real k6_i =  h6_i*casl*kcaon;
real x1_i =  k2_i*k4_i*(k7_i+k6_i)+ k5_i*k7_i*(k2_i+k3_i);
real x2_i =  k1_i*k7_i*(k4_i+k5_i)+ k4_i*k6_i*(k1_i+k8_i);
real x3_i =  k1_i*k3_i*(k7_i+k6_i)+ k8_i*k6_i*(k2_i+k3_i);
real x4_i =  k2_i*k8_i*(k4_i+k5_i)+ k3_i*k5_i*(k1_i+k8_i);
real E1_i = x1_i/(x1_i+x2_i+x3_i+x4_i);
real E2_i = x2_i/(x1_i+x2_i+x3_i+x4_i);
real E3_i = x3_i/(x1_i+x2_i+x3_i+x4_i);
real E4_i = x4_i/(x1_i+x2_i+x3_i+x4_i);
real JncxNa_i = ( 3.00000*( E4_i*k7_i -  E1_i*k8_i)+ E3_i*k4pp_i) -  E2_i*k3pp_i;
real JncxCa_i =  E2_i*k2_i -  E1_i*k1_i;
real INaCa_i =  0.800000*Gncx*allo_i*( zna*JncxNa_i+ zca*JncxCa_i);
real INab = ( PNab*vffrt*( nasl*exp(vfrt) - nao))/(exp(vfrt) - 1.00000);
real IpCa = ( GpCa*casl)/(KmCap+casl);
real ICab = ( PCab*4.00000*vffrt*( casl*exp( 2.00000*vfrt) -  0.341000*cao))/(exp( 2.00000*vfrt) - 1.00000);
real JgapNa = (nasl - nai)/gaptau;
real Jdiff = (cass - casl)/sstau;
real Jgap = (casl - cai)/gaptau;
real dkmplb = ( dkmplbbar*CaMKa)/(CaMKa+KmCaMK);
real dqupcamk = ( dqupcamkbar*CaMKa)/(CaMKa+KmCaMK);
real Jup1 = ( 0.000200000*(dqupcamk+1.00000))/(1.00000+(kmup - dkmplb)/casl) - ( 0.00105000*cansr)/nsrbar;
real Bcasl = 1.00000/(1.00000+( cmdnmaxsl*kmcmdn)/pow(kmcmdn+casl, 2.00000)+( trpnmaxsl*kmtrpn)/pow(kmtrpn+casl, 2.00000));
real Jup2 = ( 0.00260000*(dqupcamk+1.00000))/(1.00000+(kmup - dkmplb)/cai) - ( 0.00420000*cansr)/nsrbar;
real Bcai = 1.00000/(1.00000+( cmdnmax*kmcmdn)/pow(kmcmdn+cai, 2.00000)+( trpnmax*kmtrpn)/pow(kmtrpn+cai, 2.00000));
real POip3 = ( tauip3*IP3*cass*(1.00000 - u))/( (1.00000+( IP3*k0)/k0a)*(1.00000+( cass*k1)/k1a));
real Jip3 =  10.9200*POip3*(cajsr - cass);
real Bcass = 1.00000/(1.00000+( BSRmax*KmBSR)/pow(KmBSR+cass, 2.00000)+( BSLmax*KmBSL)/pow(KmBSL+cass, 2.00000));
real REL2 = ( Jgap*vsl)/vmyo+( - Jup2*vnsr)/vmyo+( Jrel2*vcsr)/vmyo;
real irelss2 = (REL2>0.00000 ? ( 91.0000*(1.00000+( 1.00000*1.00000)/(1.00000+pow(0.280000/CaMKa, 8.00000)))*REL2)/(1.00000+pow(1.00000/cacsr, 8.00000)) : 0.00000);
real ireltau2 = ( 6.00000*(1.00000+( 1.00000*1.00000)/(1.00000+pow(0.280000/CaMKa, 8.00000))))/(1.00000+0.0123000/cacsr);
real Jtr1 = (cansr - cajsr)/120.000;
real Bcajsr = 1.00000/(1.00000+( csqnmaxsl*kmcsqn)/pow(kmcsqn+cajsr, 2.00000));
real Jtr2 = (cansr - cacsr)/120.000;
real Bcacsr = 1.00000/(1.00000+( csqnmax*kmcsqn)/pow(kmcsqn+cacsr, 2.00000));
real REL = - (( ICaL*Acap)/( vss*F*2.00000)+( - (Jrel1+Jip3)*vjsr)/vss+Jdiff);
real irelss = (REL>0.00000 ? ( 15.0000*(1.00000+( 1.00000*1.00000)/(1.00000+pow(0.280000/CaMKa, 8.00000)))*REL)/(1.00000+pow(1.00000/cajsr, 8.00000)) : 0.00000);
real ireltau = ( 2.00000*(1.00000+( 1.00000*1.00000)/(1.00000+pow(0.280000/CaMKa, 8.00000))))/(1.00000+0.0123000/cajsr);

// Hodkin-Huxley equations coefficients 'a' and 'b'
a_[16]  = -1.0 / tm;
a_[17]  = -1.0 / thf;
a_[18]  = -1.0 / ths;
a_[19]  = -1.0 / tj;
a_[20]  = -1.0 / thsp;
a_[21]  = -1.0 / tjp;
a_[22]  = -1.0 / tmL;
a_[23]  = -1.0 / thL;
a_[24]  = -1.0 / thLp;
a_[25]  = -1.0 / taua;
a_[26]  = -1.0 / tauis;
a_[27]  = -1.0 / tauif;
a_[28]  = -1.0 / td;
a_[29]  = -1.0 / tff;
a_[30]  = -1.0 / tfs;
a_[31]  = -1.0 / tfcaf;
a_[32]  = -1.0 / tfcas;
a_[33]  = -1.0 / tjca;
a_[34]  = -1.0 / tffp;
a_[35]  = -1.0 / tfcafp;
a_[37]  = -1.0 / taub;
a_[38]  = -1.0 / taug;
a_[39]  = -1.0 / txrf;
a_[40]  = -1.0 / txrs;
a_[41]  = -1.0 / txs1;
a_[42]  = -1.0 / txs2;
a_[43]  = -1.0 / tauy;
a_[44]  = -1.0 / txk1;

b_[16]  = mss / tm;
b_[17]  = hss / thf;
b_[18]  = hss / ths;
b_[19]  = jss / tj;
b_[20]  = hssp / thsp;
b_[21]  = jss / tjp;
b_[22]  = mLss / tmL;
b_[23]  = hLss / thL;
b_[24]  = hLssp / thLp;
b_[25]  = ass / taua;
b_[26]  = iss / tauis;
b_[27]  = iss / tauif;
b_[28]  = dss / td;
b_[29]  = fss / tff;
b_[30]  = fss / tfs;
b_[31]  = fcass / tfcaf;
b_[32]  = fcass / tfcas;
b_[33]  = fcass / tjca;
b_[34]  = fss / tffp;
b_[35]  = fcass / tfcafp;
b_[37]  = bss / taub;
b_[38]  = gss / taug;
b_[39]  = xrss / txrf;
b_[40]  = xrss / txrs;
b_[41]  = xs1ss / txs1;
b_[42]  = xs2ss / txs2;
b_[43]  = yss / tauy;
b_[44]  = xk1ss / txk1;

// RHS
rDY_[0] = - (INa+INaL+Ito+Isus+ICaL+ICaT+ICaNa+ICaK+IKr+IKs+If+IK1+INaCa_i+INaCa_ss+INaK+INab+IpCa+ICab+Istim);
rDY_[1] =  aCaMK*CaMKb*(CaMKb+CaMKt) -  bCaMK*CaMKt;
rDY_[2] =  Bcass*((( - (ICaL -  2.00000*INaCa_ss)*cm*Acap)/( 2.00000*F*vss)+( (Jrel1+Jip3)*vjsr)/vss) - Jdiff);
rDY_[3] = ( JgapNa*vsl)/vmyo;
rDY_[4] = ( - (INa+INaL+ 3.00000*INaCa_i+ 3.00000*INaK+IfNa+INab)*Acap*cm)/( F*vsl)+( JdiffNa*vss)/vsl+- JgapNa;
rDY_[5] = ( - (ICaNa+ 3.00000*INaCa_ss)*cm*Acap)/( F*vss) - JdiffNa;
rDY_[6] = ( JgapK*vsl)/vmyo;
rDY_[7] = ( - ICaK*cm*Acap)/( F*vss) - JdiffK;
rDY_[8] = ( - ((Ito+Isus+IKr+IKs+IfK+IK1+Istim) -  2.00000*INaK)*cm*Acap)/( F*vsl)+( JdiffK*vss)/vsl+- JgapK;
rDY_[9] =  Bcai*((( Jgap*vsl)/vmyo+( Jrel2*vcsr)/vmyo) - ( Jup2*vnsr)/vmyo);
rDY_[10] =  Bcasl*((( - ((IpCa+ICab+ICaT) -  2.00000*INaCa_i)*cm*Acap)/( 2.00000*F*vsl) - ( Jup1*vnsr)/vsl)+- Jgap+( Jdiff*vss)/vsl);
rDY_[11] = (Jup1+Jup2) - (( Jtr1*vjsr)/vnsr+( Jtr2*vcsr)/vnsr);
rDY_[12] =  Bcajsr*(Jtr1 - (Jrel1+Jip3));
rDY_[13] =  Bcacsr*(Jtr2 - Jrel2);
rDY_[14] = (irelss - Jrel1)/ireltau;
rDY_[15] = (irelss2 - Jrel2)/ireltau2;
rDY_[16] = (mss - m)/tm;
rDY_[17] = (hss - hf)/thf;
rDY_[18] = (hss - hs)/ths;
rDY_[19] = (jss - j)/tj;
rDY_[20] = (hssp - hsp)/thsp;
rDY_[21] = (jss - jp)/tjp;
rDY_[22] = (mLss - mL)/tmL;
rDY_[23] = (hLss - hL)/thL;
rDY_[24] = (hLssp - hLp)/thLp;
rDY_[25] = (ass - a)/taua;
rDY_[26] = (iss - i1)/tauis;
rDY_[27] = (iss - i2)/tauif;
rDY_[28] = (dss - d)/td;
rDY_[29] = (fss - ff)/tff;
rDY_[30] = (fss - fs)/tfs;
rDY_[31] = (fcass - fcaf)/tfcaf;
rDY_[32] = (fcass - fcas)/tfcas;
rDY_[33] = (fcass - jca)/tjca;
rDY_[34] = (fss - ffp)/tffp;
rDY_[35] = (fcass - fcafp)/tfcafp;
rDY_[36] =  anca*k2n -  nca*km2n;
rDY_[37] = (bss - b)/taub;
rDY_[38] = (gss - g)/taug;
rDY_[39] = (xrss - xrf)/txrf;
rDY_[40] = (xrss - xrs)/txrs;
rDY_[41] = (xs1ss - xs1)/txs1;
rDY_[42] = (xs2ss - xs2)/txs2;
rDY_[43] = (yss - y)/tauy;
rDY_[44] = (xk1ss - xk1)/txk1;
rDY_[45] =  cass*k2*(1.00000 - u) -  k2a*u;